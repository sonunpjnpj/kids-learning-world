<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stories - Kids Learning World</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Stories Page Specific Styles */
        .stories-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .story-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .story-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .story-card:hover {
            transform: translateY(-10px);
            border-color: #4CAF50;
            box-shadow: 0 12px 20px rgba(76, 175, 80, 0.2);
        }

        .story-icon {
            font-size: 3rem;
            color: #FF9800;
            margin-bottom: 15px;
        }

        .story-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        .story-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .story-moral {
            background: #E8F5E9;
            padding: 10px;
            border-radius: 10px;
            font-style: italic;
            color: #2E7D32;
            font-weight: bold;
        }

        /* Story Reader */
        .story-reader {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid #e0e0e0;
        }

        .story-reader.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .story-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .story-title {
            color: #2196F3;
            font-size: 2rem;
            margin: 0;
        }

        .story-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .control-btn {
            padding: 10px 20px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #1976D2;
            transform: scale(1.05);
        }

        .control-btn.secondary {
            background: #9C27B0;
        }

        .control-btn.secondary:hover {
            background: #7B1FA2;
        }

        .story-content {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #333;
            margin-bottom: 30px;
            min-height: 200px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .story-choices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .choice-btn {
            padding: 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .choice-btn:hover {
            background: #388E3C;
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(76, 175, 80, 0.3);
        }

        .choice-number {
            background: white;
            color: #4CAF50;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Audio Player */
        .audio-player {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .audio-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .audio-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #2196F3;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .audio-btn:hover {
            background: #1976D2;
            transform: scale(1.1);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #volume-slider {
            width: 100px;
        }

        /* Story Navigation */
        .story-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .nav-btn {
            padding: 12px 30px;
            background: #FF9800;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .nav-btn:hover:not(:disabled) {
            background: #F57C00;
            transform: translateY(-3px);
        }

        .page-indicator {
            font-size: 1.2rem;
            color: #666;
            font-weight: bold;
        }

        /* Character Display */
        .character-display {
            text-align: center;
            margin: 20px 0;
        }

        .character-img {
            font-size: 5rem;
            margin-bottom: 10px;
        }

        .character-name {
            font-size: 1.5rem;
            color: #2196F3;
            font-weight: bold;
        }

        /* Comprehension Questions */
        .questions-section {
            display: none;
            background: #E3F2FD;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .questions-section.active {
            display: block;
        }

        .question {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .option {
            padding: 15px;
            background: #f9f9f9;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option:hover {
            background: #e0e0e0;
        }

        .option.selected {
            background: #4CAF50;
            color: white;
            border-color: #388E3C;
        }

        .submit-btn {
            padding: 15px 40px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: #388E3C;
            transform: scale(1.05);
        }

        .result {
            font-size: 1.3rem;
            font-weight: bold;
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .result.correct {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .result.wrong {
            background: #FFEBEE;
            color: #c62828;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .story-selection {
                grid-template-columns: 1fr;
            }
            
            .story-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .story-controls {
                justify-content: center;
            }
            
            .story-choices {
                grid-template-columns: 1fr;
            }
            
            .audio-player {
                flex-direction: column;
                text-align: center;
            }
            
            .story-nav {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-book"></i>
                <h1>Interactive Stories</h1>
            </div>
            <nav>
                <a href="index.html"><i class="fas fa-home"></i> Home</a>
                <a href="alphabet.html"><i class="fas fa-font"></i> Alphabet</a>
                <a href="math.html"><i class="fas fa-calculator"></i> Math</a>
                <a href="coloring.html"><i class="fas fa-palette"></i> Coloring</a>
                <a href="stories.html" class="active"><i class="fas fa-book"></i> Stories</a>
            </nav>
        </header>

        <main>
            <div class="page-header">
                <h2><i class="fas fa-book-reader"></i> Choose Your Adventure!</h2>
                <p>Interactive stories with choices, audio, and moral lessons</p>
            </div>

            <div class="stories-container">
                <!-- Story Selection -->
                <div class="story-selection" id="story-selection">
                    <!-- Story cards will be added by JavaScript -->
                </div>

                <!-- Story Reader -->
                <div class="story-reader" id="story-reader">
                    <div class="story-header">
                        <h2 class="story-title" id="story-title">The Curious Rabbit</h2>
                        <div class="story-controls">
                            <button class="control-btn" onclick="toggleAudio()" id="audio-toggle">
                                <i class="fas fa-play"></i> <span>Listen</span>
                            </button>
                            <button class="control-btn secondary" onclick="showQuestions()">
                                <i class="fas fa-question-circle"></i> Quiz
                            </button>
                            <button class="control-btn" onclick="backToStories()">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Audio Player -->
                    <div class="audio-player" id="audio-player">
                        <div class="character-display">
                            <div class="character-img" id="character-img">üê∞</div>
                            <div class="character-name" id="character-name">Robby Rabbit</div>
                        </div>
                        
                        <div class="audio-controls">
                            <button class="audio-btn" onclick="playAudio()" id="play-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="audio-btn" onclick="pauseAudio()" id="pause-btn">
                                <i class="fas fa-pause"></i>
                            </button>
                            <button class="audio-btn" onclick="stopAudio()">
                                <i class="fas fa-stop"></i>
                            </button>
                            
                            <div class="volume-control">
                                <i class="fas fa-volume-up"></i>
                                <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="0.5">
                            </div>
                        </div>
                        
                        <div class="audio-progress">
                            <progress id="audio-progress" value="0" max="100" style="width: 200px;"></progress>
                            <span id="time-display">0:00 / 0:00</span>
                        </div>
                    </div>

                    <!-- Story Content -->
                    <div class="story-content" id="story-content">
                        <!-- Story content will be loaded by JavaScript -->
                    </div>

                    <!-- Story Choices -->
                    <div class="story-choices" id="story-choices">
                        <!-- Choices will be loaded by JavaScript -->
                    </div>

                    <!-- Story Navigation -->
                    <div class="story-nav">
                        <button class="nav-btn" onclick="previousPage()" id="prev-btn" disabled>
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        
                        <div class="page-indicator">
                            Page <span id="current-page">1</span> of <span id="total-pages">5</span>
                        </div>
                        
                        <button class="nav-btn" onclick="nextPage()" id="next-btn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Comprehension Questions -->
                <div class="questions-section" id="questions-section">
                    <h3><i class="fas fa-graduation-cap"></i> Story Comprehension Quiz</h3>
                    <div id="questions-container">
                        <!-- Questions will be loaded by JavaScript -->
                    </div>
                    <button class="submit-btn" onclick="submitQuiz()">Submit Answers</button>
                    <div id="quiz-result"></div>
                </div>
            </div>
        </main>

        <footer>
            <p>¬© 2023 Kids Learning World</p>
            <p>Reading builds imagination!</p>
        </footer>
    </div>

    <script>
        // Story Data
        const stories = [
            {
                id: 'curious-rabbit',
                title: 'The Curious Rabbit',
                icon: 'üê∞',
                color: '#FF9800',
                moral: 'Curiosity leads to learning, but be careful!',
                pages: [
                    {
                        content: "Once upon a time, there was a curious little rabbit named Robby. Robby loved exploring the forest behind his burrow.",
                        character: "üê∞ Robby Rabbit",
                        choices: [
                            { text: "Explore the forest", nextPage: 1 },
                            { text: "Stay safe in the burrow", nextPage: 2 }
                        ]
                    },
                    {
                        content: "Robby hopped through the forest and found a beautiful garden with colorful flowers. He saw a butterfly flying around.",
                        character: "ü¶ã Butterfly",
                        choices: [
                            { text: "Follow the butterfly", nextPage: 3 },
                            { text: "Smell the flowers", nextPage: 4 }
                        ]
                    },
                    {
                        content: "Robby decided to stay safe. He helped his mother clean their burrow and learned how to make a comfortable nest.",
                        character: "üê∞ Mother Rabbit",
                        choices: [
                            { text: "Learn about different plants", nextPage: 5 },
                            { text: "Practice hopping skills", nextPage: 6 }
                        ]
                    },
                    {
                        content: "The butterfly led Robby to a wise old owl who was reading a book under a tree.",
                        character: "ü¶â Wise Owl",
                        choices: [
                            { text: "Ask about the book", nextPage: 7 },
                            { text: "Ask about the forest", nextPage: 8 }
                        ]
                    },
                    {
                        content: "Robby smelled the flowers and learned their names from a friendly bee. He discovered which flowers make the sweetest honey.",
                        character: "üêù Friendly Bee",
                        choices: [
                            { text: "Learn about pollination", nextPage: 9 },
                            { text: "Taste different flowers", nextPage: 10 }
                        ]
                    }
                ],
                questions: [
                    {
                        question: "What was the rabbit's name?",
                        options: ["Robby", "Bobby", "Hoppy", "Fluffy"],
                        correct: 0
                    },
                    {
                        question: "What did Robby find in the forest?",
                        options: ["A garden", "A river", "A mountain", "A cave"],
                        correct: 0
                    },
                    {
                        question: "What is the moral of this story?",
                        options: [
                            "Curiosity leads to learning",
                            "Stay home always",
                            "Never explore",
                            "Be afraid of everything"
                        ],
                        correct: 0
                    }
                ]
            },
            {
                id: 'brave-lion',
                title: 'The Brave Little Lion',
                icon: 'ü¶Å',
                color: '#FF9800',
                moral: 'True bravery means helping others',
                pages: [
                    {
                        content: "Leo was a small lion cub who wanted to be brave like his father, the king of the jungle.",
                        character: "ü¶Å Leo Lion Cub",
                        choices: [
                            { text: "Practice roaring", nextPage: 1 },
                            { text: "Help a friend", nextPage: 2 }
                        ]
                    },
                    {
                        content: "Leo practiced roaring every day. His roar was still small, but he kept trying.",
                        character: "ü¶Å Leo Lion Cub",
                        choices: [
                            { text: "Ask father for advice", nextPage: 3 },
                            { text: "Try different techniques", nextPage: 4 }
                        ]
                    },
                    {
                        content: "Leo saw a little bird that had fallen from its nest. The bird was scared and couldn't fly.",
                        character: "üê¶ Baby Bird",
                        choices: [
                            { text: "Help the bird", nextPage: 5 },
                            { text: "Find the bird's mother", nextPage: 6 }
                        ]
                    }
                ],
                questions: [
                    {
                        question: "What did Leo want to be?",
                        options: ["Brave", "Fast", "Strong", "Smart"],
                        correct: 0
                    },
                    {
                        question: "Who did Leo help in the story?",
                        options: ["A bird", "A rabbit", "A monkey", "An elephant"],
                        correct: 0
                    }
                ]
            },
            {
                id: 'kind-elephant',
                title: 'Ellie the Kind Elephant',
                icon: 'üêò',
                color: '#9C27B0',
                moral: 'Kindness is the strongest power',
                pages: [
                    {
                        content: "Ellie was a young elephant who loved helping all the animals in the jungle.",
                        character: "üêò Ellie Elephant",
                        choices: [
                            { text: "Help water the plants", nextPage: 1 },
                            { text: "Clear a path", nextPage: 2 }
                        ]
                    },
                    {
                        content: "Ellie used her trunk to spray water on the dry plants. The flowers began to bloom again.",
                        character: "üå∫ Flowers",
                        choices: [
                            { text: "Water more plants", nextPage: 3 },
                            { text: "Take a break", nextPage: 4 }
                        ]
                    }
                ],
                questions: [
                    {
                        question: "What did Ellie use to help others?",
                        options: ["Her trunk", "Her ears", "Her tail", "Her feet"],
                        correct: 0
                    },
                    {
                        question: "What is the story's main lesson?",
                        options: ["Be kind", "Be strong", "Be fast", "Be loud"],
                        correct: 0
                    }
                ]
            },
            {
                id: 'clever-monkey',
                title: 'Milo the Clever Monkey',
                icon: 'üêµ',
                color: '#FF5722',
                moral: 'Using your brain is better than using strength',
                pages: [
                    {
                        content: "Milo was a clever monkey who could solve any problem in the jungle.",
                        character: "üêµ Milo Monkey",
                        choices: [
                            { text: "Solve a puzzle", nextPage: 1 },
                            { text: "Help friends", nextPage: 2 }
                        ]
                    },
                    {
                        content: "The animals needed to reach delicious fruits on a tall tree, but nobody could climb that high.",
                        character: "üçå Banana Tree",
                        choices: [
                            { text: "Build something", nextPage: 3 },
                            { text: "Ask for help", nextPage: 4 }
                        ]
                    }
                ],
                questions: [
                    {
                        question: "What was Milo good at?",
                        options: ["Solving problems", "Climbing trees", "Making noises", "Eating fruits"],
                        correct: 0
                    },
                    {
                        question: "How did Milo help his friends?",
                        options: ["By thinking", "By fighting", "By running", "By hiding"],
                        correct: 0
                    }
                ]
            }
        ];

        // State Variables
        let currentStory = null;
        let currentPageIndex = 0;
        let currentAudio = null;
        let isAudioPlaying = false;
        let userAnswers = [];

        // Initialize
        function init() {
            createStoryCards();
            setupAudioControls();
        }

        // Create Story Cards
        function createStoryCards() {
            const storySelection = document.getElementById('story-selection');
            storySelection.innerHTML = '';
            
            stories.forEach(story => {
                const card = document.createElement('div');
                card.className = 'story-card';
                card.style.borderColor = story.color;
                card.onclick = () => startStory(story);
                
                card.innerHTML = `
                    <div class="story-icon">${story.icon}</div>
                    <h3>${story.title}</h3>
                    <p>${story.pages.length} interactive pages</p>
                    <div class="story-moral">${story.moral}</div>
                `;
                
                storySelection.appendChild(card);
            });
        }

        // Start Story
        function startStory(story) {
            currentStory = story;
            currentPageIndex = 0;
            userAnswers = [];
            
            // Hide story selection, show reader
            document.getElementById('story-selection').style.display = 'none';
            document.getElementById('story-reader').classList.add('active');
            document.getElementById('questions-section').classList.remove('active');
            
            // Update story info
            document.getElementById('story-title').textContent = story.title;
            document.getElementById('character-img').textContent = story.icon;
            document.getElementById('character-name').textContent = story.title;
            
            loadPage(currentPageIndex);
            updateNavigation();
        }

        // Load Page
        function loadPage(pageIndex) {
            if (!currentStory || !currentStory.pages[pageIndex]) return;
            
            const page = currentStory.pages[pageIndex];
            
            // Update content
            document.getElementById('story-content').textContent = page.content;
            document.getElementById('character-name').textContent = page.character;
            
            // Update page indicator
            document.getElementById('current-page').textContent = pageIndex + 1;
            document.getElementById('total-pages').textContent = currentStory.pages.length;
            
            // Create choices
            const choicesContainer = document.getElementById('story-choices');
            choicesContainer.innerHTML = '';
            
            if (page.choices && page.choices.length > 0) {
                page.choices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.onclick = () => selectChoice(choice.nextPage - 1);
                    
                    button.innerHTML = `
                        <div class="choice-number">${index + 1}</div>
                        <span>${choice.text}</span>
                    `;
                    
                    choicesContainer.appendChild(button);
                });
            } else {
                choicesContainer.innerHTML = '<p style="text-align: center; color: #666;">The end of this story branch. Try different choices!</p>';
            }
            
            // Prepare audio text
            prepareAudio(page.content);
            
            // Update navigation buttons
            updateNavigation();
        }

        // Select Choice
        function selectChoice(nextPageIndex) {
            if (nextPageIndex >= 0 && nextPageIndex < currentStory.pages.length) {
                currentPageIndex = nextPageIndex;
                loadPage(currentPageIndex);
                
                // Add some feedback
                const buttons = document.querySelectorAll('.choice-btn');
                buttons.forEach(btn => btn.classList.remove('selected'));
                event.target.closest('.choice-btn').classList.add('selected');
            }
        }

        // Update Navigation
        function updateNavigation() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentPageIndex === 0;
            nextBtn.disabled = currentPageIndex === currentStory.pages.length - 1;
        }

        // Navigation Functions
        function previousPage() {
            if (currentPageIndex > 0) {
                currentPageIndex--;
                loadPage(currentPageIndex);
            }
        }

        function nextPage() {
            if (currentPageIndex < currentStory.pages.length - 1) {
                currentPageIndex++;
                loadPage(currentPageIndex);
            }
        }

        // Back to Stories
        function backToStories() {
            document.getElementById('story-reader').classList.remove('active');
            document.getElementById('story-selection').style.display = 'grid';
            document.getElementById('questions-section').classList.remove('active');
            
            if (currentAudio) {
                currentAudio.pause();
                isAudioPlaying = false;
                updateAudioButton();
            }
        }

        // Audio Functions
        function setupAudioControls() {
            const volumeSlider = document.getElementById('volume-slider');
            volumeSlider.addEventListener('input', function() {
                if (currentAudio) {
                    currentAudio.volume = this.value;
                }
            });
        }

        function prepareAudio(text) {
            // In a real application, you would use pre-recorded audio files
            // For this demo, we'll use the Web Speech API for text-to-speech
            
            // Store text for speech synthesis
            window.speechText = text;
        }

        function toggleAudio() {
            if (isAudioPlaying) {
                stopAudio();
            } else {
                playAudio();
            }
        }

        function playAudio() {
            if ('speechSynthesis' in window) {
                if (currentAudio) {
                    window.speechSynthesis.cancel();
                }
                
                const speech = new SpeechSynthesisUtterance(window.speechText);
                speech.rate = 0.9;
                speech.pitch = 1;
                speech.volume = document.getElementById('volume-slider').value;
                
                speech.onstart = function() {
                    isAudioPlaying = true;
                    updateAudioButton();
                    startProgressAnimation();
                };
                
                speech.onend = function() {
                    isAudioPlaying = false;
                    updateAudioButton();
                    resetProgress();
                };
                
                window.speechSynthesis.speak(speech);
                currentAudio = speech;
            } else {
                alert("Your browser doesn't support text-to-speech. Try Chrome or Edge.");
            }
        }

        function pauseAudio() {
            if (window.speechSynthesis && isAudioPlaying) {
                window.speechSynthesis.pause();
                isAudioPlaying = false;
                updateAudioButton();
            }
        }

        function stopAudio() {
            if (window.speechSynthesis) {
                window.speechSynthesis.cancel();
                isAudioPlaying = false;
                updateAudioButton();
                resetProgress();
            }
        }

        function updateAudioButton() {
            const button = document.getElementById('audio-toggle');
            const icon = button.querySelector('i');
            const text = button.querySelector('span');
            
            if (isAudioPlaying) {
                icon.className = 'fas fa-pause';
                text.textContent = 'Pause';
            } else {
                icon.className = 'fas fa-play';
                text.textContent = 'Listen';
            }
        }

        function startProgressAnimation() {
            const progress = document.getElementById('audio-progress');
            let progressValue = 0;
            
            const interval = setInterval(() => {
                if (progressValue < 100 && isAudioPlaying) {
                    progressValue += 1;
                    progress.value = progressValue;
                    
                    // Update time display
                    const currentTime = Math.floor(progressValue * 0.3); // Simulated time
                    const totalTime = 30; // Simulated total time
                    const minutes = Math.floor(currentTime / 60);
                    const seconds = currentTime % 60;
                    document.getElementById('time-display').textContent = 
                        `${minutes}:${seconds.toString().padStart(2, '0')} / 0:30`;
                } else {
                    clearInterval(interval);
                }
            }, 300); // Update every 300ms for 30 second simulation
        }

        function resetProgress() {
            document.getElementById('audio-progress').value = 0;
            document.getElementById('time-display').textContent = '0:00 / 0:00';
        }

        // Quiz Functions
        function showQuestions() {
            document.getElementById('questions-section').classList.add('active');
            loadQuestions();
        }

        function loadQuestions() {
            if (!currentStory) return;
            
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            userAnswers = new Array(currentStory.questions.length).fill(null);
            
            currentStory.questions.forEach((question, qIndex) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';
                
                question.options.forEach((option, oIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = () => selectAnswer(qIndex, oIndex, optionDiv);
                    
                    optionsDiv.appendChild(optionDiv);
                });
                
                questionDiv.innerHTML = `
                    <div class="question-text">${qIndex + 1}. ${question.question}</div>
                `;
                questionDiv.appendChild(optionsDiv);
                container.appendChild(questionDiv);
            });
        }

        function selectAnswer(questionIndex, optionIndex, element) {
            // Remove selection from all options in this question
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            
            // Select clicked option
            element.classList.add('selected');
            userAnswers[questionIndex] = optionIndex;
        }

        function submitQuiz() {
            if (!currentStory) return;
            
            let score = 0;
            const resultDiv = document.getElementById('quiz-result');
            
            currentStory.questions.forEach((question, index) => {
                if (userAnswers[index] === question.correct) {
                    score++;
                }
            });
            
            const percentage = (score / currentStory.questions.length) * 100;
            
            resultDiv.className = `result ${percentage >= 70 ? 'correct' : 'wrong'}`;
            resultDiv.innerHTML = `
                <h3>Quiz Results</h3>
                <p>You scored ${score} out of ${currentStory.questions.length}</p>
                <p>That's ${percentage.toFixed(0)}%</p>
                ${percentage >= 70 ? 
                    '<p>üéâ Excellent! You understood the story well!</p>' : 
                    '<p>Try reading the story again and pay attention to details!</p>'
                }
            `;
            
            // Speak result
            if ('speechSynthesis' in window) {
                const speech = new SpeechSynthesisUtterance(
                    `You scored ${score} out of ${currentStory.questions.length}. ${percentage >= 70 ? 'Excellent!' : 'Try again!'}`
                );
                speech.rate = 0.9;
                window.speechSynthesis.speak(speech);
            }
        }

        // Initialize when page loads
        window.onload = init;
    </script>
</body>
</html>